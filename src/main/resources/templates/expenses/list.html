<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>All Expenses</title>
    <meta charset="UTF-8">
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<div class="container">

    <div class="header">
        <h2>All Expenses</h2>
        <a th:href="@{/expenses/new}" class="btn btn-success">
            + Add Expense
        </a>
    </div>

    <!-- Total Card -->
    <div class="summary-card">
        <h3>Total Expenses</h3>
        <h2>₹ <span th:text="${totalAmount}"></span></h2>
    </div>

    <!-- Filter Section -->
    <div class="filter-box">
        <h3>Filter Expenses</h3>

        <form th:action="@{/expenses/filter}" method="get">

            <label>Month</label>
            <input type="month"
                   name="yearMonth"
                   th:value="${selectedMonth}">

            <label>Category</label>
            <select name="category">
                <option value="">All Categories</option>
                <option th:each="cat : ${categories}"
                        th:value="${cat}"
                        th:text="${cat}"
                        th:selected="${cat == selectedCategory}">
                </option>
            </select>

            <button type="submit" class="btn btn-primary">
                Apply Filter
            </button>

            <a th:href="@{/expenses}" class="btn btn-reset">
                Reset
            </a>

        </form>
    </div>

    <table>
        <tr>
            <th>ID</th>
            <th>Amount</th>
            <th>Category</th>
            <th>Date</th>
            <th>Description</th>
            <th>Actions</th>
        </tr>

        <tr th:each="exp : ${expenses}">
            <td th:text="${exp.id}"></td>
            <td>₹ <span th:text="${exp.amount}"></span></td>
            <td th:text="${exp.category}"></td>
            <td th:text="${exp.date}"></td>
            <td th:text="${exp.description}"></td>
            <td>
                <a th:href="@{/expenses/edit/{id}(id=${exp.id})}"
                   class="btn btn-primary">Edit</a>

                <a th:href="@{/expenses/delete/{id}(id=${exp.id})}"
                   class="btn btn-danger"
                   onclick="return confirm('Are you sure you want to delete this expense?');">
                    Delete
                </a>
            </td>
        <tr th:if="${#lists.isEmpty(expenses)}">
            <td colspan="6">No expenses found</td>
        </tr>
        </tr>
    </table>

</div>

</body>
</html>